<!DOCTYPE html>
<html>
  <head>
        <style> 
            h1 {
                 text-align: center;
            }
            h3 {
                  display: inline-block;
                  line-height: 5px;
            }
            hr{
                  padding: 0px;
                  margin: 0px;
            }

            .divBox {
                  border-radius: 25px;
                  width: 99%;
                  padding: 1px;
                  border: 2px solid gray;
                  margin: 10 px;
                  background-color: #E8E8E8;
                  align-self: center;
            }

            .emptyTables th{
                  width: 200px;
                  font-size: 15px;
            }
            .emptyTables td{
                  font-size: 13px;
                  text-align: center;
            }
            .emptyTables hr{
                  color: #808080;
            }

                              
           
            .fullTables{
                  border-radius: 18px;
                  border-top-left-radius: 0px;
                  border-top-right-radius: 0px;
                  background-color: #F8F8F8;
            } 
            .fullTables th{
                  width: 200px;
                  font-size: 15px;
            } 
            .fullTables td{
                  font-size: 13px;
                  text-align: center;
            }
            .fullTables hr{
                  color: #808080;
            }   
                            
        </style>
    <title>Profile Page</title>

    <link rel="stylesheet" href=
"https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">

  </head>
  
  <body>
      {% include 'header.html' %}
            <form method="get" action="logout" > 
                  <input type="submit" name="logout"  value="Logout">
            </form>


            <!-- (Emmandra) This will eventually be attached to the accept button im just testing-->
            <form method="get" action="/checkout">
                  <input type="submit" name='checkout' id=checkout value="Checkout">
            </form>
      <h1>Welcome {{user}}!</h1> 

      <!-- MY LISTINGS -->
      <div class= "divBox">
            {% if listings|length == 0: %}
                  <h3>My Listings: </h3> <span> You have no books listed, <a href="sellerPage"> list one here </a> </span>
                  <table class="emptyTables">
            {% else: %}
                  <h3> My Listings: </h3>
                  <table class="fullTables">
            {% endif %}
            <hr>
            <th>Book title:</th>
            <th> </th>
            <th> Course name: </th>
            <th> </th>
            <th> Highest Bidder ID: </th>
            <th> </th>
            <th> Highest Bid Price: </th>
            <th> </th>
            <th> Buy Now Price:</th>
            <th> </th>
            <th> Action: </th>
            <th></th>
            {% if listings|length == 0: %}
                  </table>
            {% else: %}
                  {%    for book in listings: %}
                        <tr>
                              <td>{{book[0]}}</td>
                              <td></td>
                              <td>{{book[1]}}</td>
                              <td></td>
                              <td>{{book[2]}}</td>
                              <td></td>
                              <td>${{book[3]}}</td>
                              <td></td>
                              <td>${{book[4]}}</td>
                              <td></td>
                              <td>
                                    {% if book[5] == 'pending' %}
                                          <form method="post", action="profilePage?list={{book[5]}}&bidder={{book[2]}}">
                                          <input type="submit" name="accept" id="accept" value="Accept">
                                          <input type="submit" name="decline" id="decline" value="Decline">
                                          </form>
                                    {% else %}
                                          {{book[5]}}
                                    {% endif %}
                              </td>
                            
                              <td><form action="/sellerPage" method="POST">
                                     <button class="glyphicon glyphicon-pencil"></button>
                                  </form>
                                  <button class="glyphicon glyphicon-trash"></span>
                              </td>
                        </tr>
                  {%    endfor %}
            {% endif %}
      </table>
      </div>
    
      <br>

      <!-- MY PURCHASES -->
      <div class= "divBox">
            {% if purchases|length == 0: %}
                  <h3>Claimed books: </h3> <span> You have not claimed any books, <a href="homePage"> search books here </a> </span>
                  <table class="emptyTables">
            {% else: %}
                  <h3> Claimed books: </h3>
                  <table class="fullTables">
            {% endif %}
            <hr>
            <th>Book title:</th>
            <th> </th>
            <th> Course name: </th>
            <th> </th>
            <th> Course title: </th>
            <th> </th>
            <th> List price: </th>
            <th> </th>
            <th> Accepted price: </th>
            {% if purchases|length == 0: %}
                  </table>
            {% else: %}
                  {%    for book in purchases: %}
                        <tr>
                              <td>{{book[0]}}</td>
                              <td></td>
                              <td>{{book[1]}}</td>
                              <td></td>
                              <td>{{book[2]}}</td>
                              <td></td>
                              <td>${{book[3]}}</td>
                              <td></td>
                              <td>${{book[4]}}</td>
                        </tr>
                  {%    endfor %}
            {% endif %}
      </table>
      </div>

      <br>

      <!-- MY BIDS -->
      <div class= "divBox">
            {% if bids|length == 0: %}
                  <h3>Current bids: </h3> <span> You have no current bids, <a href="homePage"> search books here </a> </span>
                  <table class="emptyTables">
            {% else: %}
                  <h3> Current bids: </h3>
                  <table class="fullTables">
            {% endif %}
            <hr>
            <th>Book title:</th>
            <th> </th>
            <th> Course name: </th>
            <th> </th>
            <th> Course title: </th>
            <th> </th>
            <th>Seller:</th>
            <th> </th>
            <th> My offer: </th>
            <th> </th>
            <th> Offer status: </th>
            <th></th>
            {% if bids|length == 0: %}
                  </table>
            {% else: %}
                  {%    for book in bids: %}
                        <tr>
                              <td>{{book[0]}}</td>
                              <td></td>
                              <td>{{book[1]}}</td>
                              <td></td>
                              <td>{{book[2]}}</td>
                              <td></td>
                              <td>{{book[3]}}</td>
                              <td></td>
                              <td>${{book[4]}}</td>
                              <td></td>
                              <td> {{book[5]}}</td>
                              <td><form action="/buyerPage?bookid={{book[6]}}" method="POST">
                                     <button class="glyphicon glyphicon-pencil"></button>
                                  </form>
                                  <button class="glyphicon glyphicon-trash" onclick="deleteBid({{book[0]}})"></button>
                              </td>
                        </tr>
                  {%    endfor %}
            {% endif %}
      </table>
      </div>
    <br>
    <br>
    {% include 'footer.html' %}

<!--
    <script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js">
    </script>

    let request = null;
    
    <script>

       function handleResponse(response)
       {
          $('document').html(response);
       }

       function editBid(bookid)
       {
          bookID = encodeURIComponent(bookid);
          let url = '/buyerPage?bookid=' + bookid
          
          if (request != null)
             request.abort()

          request = $.ajax(
            {
               type: 'POST',
               url: url,
               success: handleResponse
            }
          )
       }
    </script> -->
  </body>
</html>
